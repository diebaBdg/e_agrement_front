<!-- Header -->
<header class="header">
  <div class="header-container">
    <div class="logo-section">
      <div class="logo-icon">‚úì</div>
      <div class="logo-text">
        <h1 class="logo-title">Agr√©ments S√©n√©gal</h1>
        <p class="logo-subtitle">R√©publique du S√©n√©gal</p>
      </div>
    </div>
    <nav class="nav-menu">
      <a routerLink="/" class="nav-link">Accueil</a>
      <a routerLink="/nouvelle-demande" class="nav-link">Nouvelle Demande</a>
      <a routerLink="/suivre" class="nav-link active">Suivre</a>
    </nav>
    <div class="header-actions">
      <a routerLink="/connexion" class="btn-link">Connexion</a>
      <a routerLink="/inscription" class="btn-secondary">S'inscrire</a>
      <a routerLink="/nouvelle-demande" class="btn-primary">Nouvelle Demande</a>
    </div>
  </div>
</header>

<!-- Main Content -->
<main class="main-content">
  <div class="container">
    <!-- Page Title -->
    <div class="page-title-section">
      <h1 class="page-title">Suivi de Demande</h1>
      <p class="page-subtitle">
        Entrez votre num√©ro de suivi et votre email pour consulter l'√©tat de votre demande d'agr√©ment
      </p>
    </div>

    <!-- Message d'erreur -->
    <div *ngIf="error" style="padding: 1rem; background: #fee2e2; border: 1px solid #ef4444; border-radius: 8px; margin-bottom: 1.5rem; color: #dc2626;">
      {{ error }}
    </div>

    <!-- Search Section -->
    <div class="search-section">
      <div class="search-container">
        <input
          type="text"
          class="search-input"
          placeholder="Entrez votre num√©ro de suivi (ex: SN-AGR-2024-001)"
          [(ngModel)]="trackingNumber"
          (keyup.enter)="emailDemandeur ? onSearch() : null"
          [disabled]="loading"
        />
        <input
          type="email"
          class="search-input"
          placeholder="Entrez votre email"
          [(ngModel)]="emailDemandeur"
          (keyup.enter)="trackingNumber ? onSearch() : null"
          [disabled]="loading"
          style="margin-top: 1rem;"
        />
        <button class="search-btn" (click)="onSearch()" [disabled]="loading">
          <span class="search-icon" *ngIf="!loading">üîç</span>
          <span *ngIf="!loading">Rechercher</span>
          <span *ngIf="loading">Recherche...</span>
        </button>
      </div>
    </div>

    <!-- Results Section - Affich√© en bas de la recherche -->
    <div class="results-section" *ngIf="showResults">
      <!-- Application Details Card -->
      <div class="details-card">
        <div class="card-header">
          <div class="card-icon">üìÑ</div>
          <div class="card-content">
            <h2 class="card-title">{{ demandeData.nom }}</h2>
            <p class="card-type">{{ demandeData.type }}</p>
          </div>
          <div class="card-status" [class]="'status-' + demandeData.statutColor">
            <span class="status-icon">‚è∞</span>
            <span>{{ demandeData.statut }}</span>
          </div>
        </div>
        <div class="card-details">
          <div class="detail-item">
            <span class="detail-label">Num√©ro de Suivi</span>
            <span class="detail-value">{{ demandeData.numeroSuivi }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Date de Soumission</span>
            <span class="detail-value">{{ demandeData.dateSoumission }}</span>
          </div>
        </div>
      </div>

      <!-- Timeline Card -->
      <div class="timeline-card">
        <h3 class="section-title">Progression du Traitement</h3>
        <div class="timeline">
          <div 
            class="timeline-step" 
            *ngFor="let step of timelineSteps"
            [class.completed]="step.completed"
            [class.pending]="!step.completed"
          >
            <div class="step-indicator">
              <div class="step-circle" [class.completed]="step.completed">
                <span class="step-icon">{{ step.icon }}</span>
              </div>
              <div class="step-line" *ngIf="step.id < timelineSteps.length"></div>
            </div>
            <div class="step-content">
              <div class="step-header">
                <h4 class="step-title">{{ step.title }}</h4>
                <span class="step-date" *ngIf="step.completed && step.date">{{ step.date }} {{ step.time }}</span>
              </div>
              <p class="step-description">{{ step.description }}</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Documents Card -->
      <div class="documents-card" *ngIf="documents.length > 0">
        <h3 class="section-title">Documents Soumis</h3>
        <div class="documents-list">
          <div class="document-item" *ngFor="let doc of documents">
            <div class="document-info">
              <span class="document-icon">üìÑ</span>
              <div class="document-details">
                <span class="document-name">{{ doc.name }}</span>
                <span class="document-meta">{{ doc.size }} ‚Ä¢ Envoy√© le {{ doc.uploadDate }}</span>
              </div>
            </div>
            <button class="download-btn" (click)="downloadDocument(doc.id)">
              <span class="download-icon">‚¨áÔ∏è</span>
              T√©l√©charger
            </button>
          </div>
        </div>
      </div>

      <!-- Messages Card -->
      <div class="messages-card">
        <h3 class="section-title">
          <span class="messages-icon">üí¨</span>
          Messages
        </h3>
        <div class="messages-list" *ngIf="messages.length > 0">
          <div class="message-item" *ngFor="let message of messages">
            <div class="message-header">
              <span class="message-sender">{{ message.sender }}</span>
              <span class="message-time">{{ message.timestamp }}</span>
            </div>
            <p class="message-content">{{ message.content }}</p>
          </div>
        </div>
        <div *ngIf="messages.length === 0" style="text-align: center; padding: 2rem; color: #6b7280;">
          <p>Aucun message pour le moment</p>
        </div>
        <div class="message-input-section">
          <input
            type="text"
            class="message-input"
            placeholder="R√©pondre ou poser une question..."
            [(ngModel)]="replyMessage"
            (keyup.enter)="sendMessage()"
          />
          <button class="send-btn" (click)="sendMessage()">
            Envoyer
          </button>
        </div>
      </div>
    </div>
  </div>
</main>